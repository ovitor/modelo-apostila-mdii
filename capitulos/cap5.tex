% ---
% Estruturas de controle e repetição 
% ---
\chapter{Estruturas de controle e repetição}
% ---

Ao final deste capítulo, o aluno terá as seguintes competências:
\begin{enumerate}
    \item Trabalhar com estruturas de controle; e 
    \item Trabalhar com estruturas de repetição.
\end{enumerate}

As estruturas que veremos a seguir são comuns para várias linguagens de programação.
Entretanto é necessário que a apostila descreva a sintaxe dessas estruturas, resumindo
seu funcionamento.

É necessário ainda, entender o conceito de bloco. Um bloco consiste de vários
comandos agrupados com o objetivo de relacioná-los com determinado comando
ou função. Podemos (e devemos) usar blocos de comandos nas instruções que serão
vistas nesse capítulo (\comandoif, \comandofor, \comandowhile, \comandoswitch).
Os blocos de comandos devem ser utilizados para permitir que um conjunto de instruções
façam parte do mesmo contexto desejado.

Blocos em \php~são delimitados pelos caracteres \texttt{\{} e \texttt{\}}.

\section{Comando \comandoif}
\label{comando-if}

Essa estrutura condicional está entre as mais usadas na programação. Sua finalidade é induzir um 
desvio condicional, ou seja, um desvio na execução natural do programa. Caso a condição (veja sintaxe abaixo) 
seja verdadeira, então serão executadas a instruções do bloco de comando. 
Caso a condição não seja satisfeita, o bloco de comando será simplesmente ignorado. 
Veja a sintaxe e em seguida um exemplo real.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-if-1.php}

Se o teste realizado no \comandoif~for falso, ou seja, a expressão \texttt{\$media >= 7} der um
resultado \booleano~falso, o bloco de comandos não será executado.

\subsection{Comando \comandoifelse}
\label{comando-if-else}

Um complemento do comando \comandoif~é a adição da palavra chave \texttt{else}. Com esse termo
é possível tratar também as opções em que o teste é falso. Veja como fica a sintaxe da instrução
completa.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-if-2.php}

Como pode ser visto, o teste realizado \texttt{\$media >= 7} gerou um valor \booleano~
falso, resultando na execução do código relacionado ao bloco de comandos \texttt{else},
fazendo com que a mensagem exibida na tela do navegador seja ``Aluno em recuperação''.

O programador tem a possibilidade de adicionar quantos comandos \comandoifelse~
forem nescessários. Esses códigos são chamados de ``\texttt{ifs} encadeados''. 
Para facilitar, o \php~criou a palavra chave \texttt{elseif} (tudo junto mesmo).
Veja a sintaxe de uso.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-if-3.php}

\begin{framed}
{\Large Desafio rápido!}

Faça um pequeno programa que utilize a idade de um nadador, a partir dela
o programa deve indicar em qual categoria o nadador irá concorrer no próximo
campeonato. Crianças menores de 5 anos não podem competir. 
Veja como deve ser a saída do seu programa. 

\figurasimples{cap5-desafio-rapido-1}{Resultado do primeiro desafio rápido.}
\end{framed}

\section{Atribuição condicional (ternário)}
\label{atribuicao-condicional}

Esse tópico foi visto brevemente anteriormente. Vamos relembrar a sintaxe.

\lstinputlisting[language=php,style=codigos]{codigos/operadores-condicional-ternario-1.php}

Essa instrução se aplica quando queremos uma estrutura resumida, onde podemos ter um 
resultado mais direto, como por exemplo, atribuir um valor a uma variável dependendo de uma
expressão. Observe o exemplo abaixo: a variável \texttt{\$texto} receberá o valor 
``menor de 18'' ou ``maior de 18'' de acordo com o teste \texttt{\$idade > 18}.

\lstinputlisting[language=php,style=codigos]{codigos/operadores-condicional-ternario-2.php}
 
É uma estrutura semelhante ao comando \comandoifelse. Cabe ao programador escolher onde
cada uma das estruturas é melhor aplicada.

\begin{framed}
{\Large Desafio rápido!}

Faça um pequeno programa que verifique se um número é par ou ímpar. A variável
\texttt{\$num} deve ser inicializada pelo programador. O programador deve ainda
utilizar a estrutura de condição ternária e em um outro exemplo, utilizar o comando
\comandoifelse.
\end{framed}

\section{Estrutura \comandoswitch}
\label{estrutura-switch}

Observe que quando temos muitos \comandoifelse~encadeados estamos criando uma estrutura 
que não é de fácil entendimento, portanto, \textbf{não} é considerada uma boa prática de 
programação. Para resolver esse problema temos uma estrutura semelhante ao \comandoifelse. 
O comando \comandoswitch~é uma estrutura que simula uma bateria de teste sobre uma variável. 
Portanto, essa estrutura é utilizada quando é  necessário comparar a mesma variável 
com valores diferentes e executar uma ação específica em cada um desses valores. Veja
a sintaxe e um exemplo real.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-switch-1.php}

Nesse exemplo, o resultado que aparecerá no navegador é: \texttt{opcao 3} em uma linha e \texttt{opcao 4}
em outra linha. A variável \texttt{\$numero} tem o valor 3.  O comando \comandoswitch~
compara com cada \comandocase~o valor recebido. O bloco executado é o do terceiro \comandocase, 
porém, os demais também são executados. Para que tenhamos um resultado satisfatório e não seja
apresentado no navegador o restante das opções, é interessante o uso do comando \comandobreak~em 
cada \comandocase. O comando \comandobreak~tem a função de parar o bloco de execução e ``sair''
do \comandoswitch.

\subsection{Comando \comandoswitch~com \comandobreak}
\label{comando-switch-com-break}

O comando \comandobreak~é uma instrução (comando) utilizada quando queremos parar o fluxo da 
execução de um programa dentro do \comandoswitch~(e outras estruturas).
Observe o mesmo exemplo com o uso do \comandobreak. Temos agora como resultado ``opcao 3''. 
O comando \comandobreak~fez com que os demais \comandocase~abaixo do \texttt{case 3} 
não sejam executados.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-switch-2.php}

\subsection{Comando \comandoswitch~completo}
\label{comando-switch-completo}

Mas o que acontece se não tivermos um valor que seja satisfatório aos casos 
existentes no \comandoswitch? A resposta é bem simples, nenhum dos blocos seriam executados.
Porém é possível utilizarmos um comando que determina uma opção padrão caso nenhuma das outras 
venha ter resultado que satisfaça a expressão passada para o comando \comandoswitch~ 
chamada \texttt{default} (padrão).

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-switch-3.php}

A instrução passada não condiz com nenhum dos casos existentes. Por esse motivo o bloco 
pertencente ao comando \texttt{default} será executado. O comando \texttt{default} pode ser 
inserido em qualquer lugar dentro do \comandoswitch, porém caso isso aconteça, 
o uso do comando \comandobreak~deve ser adicionado para evitar que os \comandocase~abaixo 
sejam executados.

\begin{framed}
{\Large Desafio rápido!}

Faça um pequeno programa que recebe um símbolo matemático (como \tipostring) e a partir dele
faça as operações matemáticas. Utilize o comando \comandoswitch.  
\end{framed}

A partir de agora vamos aprender a trabalhar com estruturas de repetição. 
Elas são muito utilizadas nas linguagens de programação.

\section{Estrutura \comandowhile}
\label{estrutura-while}

O comando \comandowhile~é uma estrutura de controle similar ao comando \comandoif. Ele possui 
uma condição para executar um bloco de comandos. A diferença primordial é que o comando 
\comandowhile~estabelece um laço de repetição, ou seja, o bloco de comandos será executado 
repetidamente enquanto a condição passada for verdadeira. Veja a sintaxe.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-while-1.php}

Quando estamos usando um laço de repetição, podemos determinar quantas vezes ele deve 
ou não se repetir. Isso pode ser feito de forma manual - o programador determina, 
ou automaticamente - quem vai determinar é o fluxo de execução do código. Veja o exemplo
a seguir.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-while-2.php}

Nesse exemplo criamos um laço de repetição que tem como \textbf{condição de parada} o 
teste \texttt{\$num < 10}, além disso, em cada laço executado um incremento 
na variável \texttt{\$num} é realizado, fazendo com que o seu valor aumente 
(se ficou com dúvidas veja seção \ref{operadores-aritmeticos}). O laço 
\comandowhile~continuará até que a condição não seja mais satisfatória, 
em outras palavras, até que a variável \texttt{\$num} não seja menor que 10.


\begin{framed}
\textbf{{\Large Importante!}}
Tenha cuidado quando estiver trabalhando com estruturas de repetição, pois caso a expressão 
passada esteja errada, pode ocasionar um \lacoloop~infinito fazendo com que o bloco de 
código se repita infinitamente. Isso pode ocasionar um travamento do navegador ou 
até mesmo do próprio servidor WEB.
\end{framed}

Vamos ver agora um exemplo em que o laço se repete de forma automática. A condição de parada 
é uma função do \php~e não um número determinado pelo programador. A função \comandostrlen~
recebe uma variável do tipo \tipostring~e retorna a quantidade de caracteres incluindo 
também os espaços em branco. Ele poderia ser aplicado diretamente na função \funcaoecho, 
mas no exemplo, ele determina a quantidade de iterações. 

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-while-3.php}

\begin{framed}
\textbf{{\Large Desafio rápido!}}

Faça um pequeno programa que imprima no navegador os valores de 3 em 3, formando
a sequência 0, 3, 6, 9, 12... Utilize o comando \comandowhile. 

\end{framed}

\section{Estrutura \comandodowhile}
\label{estrutura-do-while}

O laço \comandodowhile~funciona de maneira bastante semelhante ao comando \comandowhile.
A diferença é que a expressão verificada está no final do bloco de comandos. Essa mudança
representa a execução do bloco \textbf{pelo menos uma vez}. Diferente do comando \comandowhile
onde é possível que o bloco não seja executado nenhuma vez. Veja a sintaxe e um exemplo
abaixo.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-do-while-1.php}

Qual seria o resultado desse código se a variável \texttt{\$num} fosse inicializada com o valor
11, ou seja, \texttt{\$num = 11;} na linha 10?

\begin{framed}
{\Large Desafio rápido!}

Faça um pequeno programa que imprima na tela somente números pares, iniciando com o 2
e terminando com o valor 20. Utilize o comando \comandodowhile. 
\end{framed}

\section{Estrutura \comandofor}

A estrutura de repetição \comandofor~tem a finalidade de criar um laço de repetição.
Sua inicialização é composta por três partes que estabelecem as regras
de funcionamento do \comandofor. Veja a sintaxe.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-for-1.php}

A primeira parte das regras chamada no código acima de ``inicialização'' é responsável
por inicializar a variável que será usada na ``condição'' e no ``atualização''. A 
segunda parte, de nome ``condição'' é responsável por fazer o teste, se o teste sobre
a condição for verdadeira, o laço do \comandofor~é executado, caso contrário
o laço termina. Por fim, a parte ``atualização'' é responsável por atualizar a variável
inicializada anteriormente, geralmente a atualização é um incremento (soma) ou 
decremento (subtração).

Verifique no exemplo abaixo a utilização do comando \comandofor.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-for-2.php}

{\Large Desafio rápido!}

Faça um pequeno programa que receba duas variáveis \texttt{\$a} e \texttt{\$b}. Você deve
apresentar na tela do navegador os números correspondentes entre \texttt{\$a} e 
\texttt{\$b}. Por exemplo: \texttt{\$a = 5} e \texttt{\$b = 11} deve ser impresso na tela
a sequência: \texttt{5, 6, 7, 8, 9, 10, 11}. Utilize o comando \comandofor.

\section{Estrutura \comandoforeach}
\label{estrutura-foreach}

O comando \comandoforeach~é um laço de repetição para interação em 
\tipoarray~(esse conteúdo será abordado no capítulo \ref{manipulacao-de-arrays}).
Trata-se do comando \comandofor~mais simplificado. Sua sintaxe é exemplificada no código abaixo.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-foreach-1.php}

Veremos adiante que um \tipoarray~é uma variável composta por vários elementos. No caso do 
exemplo anterior, esses elementos são nomes de pessoas. A finalidade do \comandoforeach~
é justamente a cada laço, pegar um desses valores e atribuir a uma variável, nesse caso, 
\texttt{\$nome}, até que tenha percorrido todo o \tipoarray~(nesse caso, \texttt{\$alunos}).

Também podemos saber em qual posição o elemento se encontra no \tipoarray, para isso basta 
adicionar uma nova variável logo após o termo \texttt{as} seguido dos caracteres \texttt{=>}.
Veja a sintaxe completa do comando \comandoforeach~e um exemplo.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-foreach-2.php}

O comando \comandoforeach~percorrerá o \tipoarray~\texttt{\$alunos} e irá apresentar
na tela o conteúdo das variáveis \texttt{\$indice} e \texttt{\$nome}. Lembrando que o
conteúdo \tipoarray~será abordado mais profundamente no próximo capítulo.

\section{Comando \comandobreak}
\label{comando-break}

O comando \comandobreak~já utilizado na instrução \comandoswitch~pode ser usado nas 
estruturas de repetição. Ele terá a mesma função, ou seja, o comando interrompe a 
execução do laço. Desse modo, o programa sai da estrutura de repetição e continua 
após o bloco. Veja o exemplo abaixo.

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-break-1.php}

No exemplo acima, utilizamos o comando \comandobreak~dentro de um laço de repetição com
o comando \comandofor. Utilizamos uma estrutura de decisão (comando \comandoif) para
realizar um teste (\texttt{\$k == 5}). Caso o teste seja verdadeiro, o programa
irá executar a linha que tem a instrução \comandobreak. Dessa maneira, o laço de 
repetição será interrompido e o restante dos números não serão impressos.

\section{Comando \comandocontinue}
\label{comando-continue}

A instrução \comandocontinue, quando executada em uma estrutura de repetição (\comandofor, 
\comandowhile~etc), ignora as instruções restantes do bloco, voltando ao início. Dessa 
forma, o programa segue para a próxima verificação da condição de entrada do laço de repetição, 
funciona de maneira semelhante ao \comandobreak, com a diferença que o fluxo ao invés 
de ser interrompido é, na realidade, voltado ao início. Veja um exemplo:

\lstinputlisting[language=php,style=codigos]{codigos/estruturas-break-2.php}

Perceba que o número 5 (do nosso teste) não foi apresentado na tela do navegador.

\section{Exercícios}
\label{cap5-exercicios}

\begin{description}[labelindent=30pt]
  \item [Q. 01] Qual a principal finalidade de uma estrutura de controle?
  \item [Q. 02] Qual a principal finalidade de uma estrutura de repetição?
  \item [Q. 03] Crie um código com uma condição ternária onde receba um valor booleano e 
  de acordo com o valor passado na expressão, deve imprimir ``sim'' ou ``não''.
  \item [Q. 04] Com o comando \comandoifelse~crie um código que determine se a expressão 
  \texttt{((4 + 5) < 9 || (3 < 5)) \&\& true} é verdadeira ou falsa.
  \item [Q. 05] Qual a finalidade da estrutura de controle \comandoswitch~e cite um exemplo onde comparamos 
  uma opção com 4 casos diferente?
  \item [Q. 06] Crie um contador de 1 até 20 usando a estrutura de repetição \comandowhile.
  \item [Q. 07] Crie um contador de 1 até 100 usando \comandodowhile.
  \item [Q. 08] Crie um contador de 100 até 1 usando \comandofor.
  \item [Q. 09] Qual a finalidade do comando \comandoforeach?
  \item [Q. 10] Crie um contador que some um infinitamente. O código deve ser parado automaticamente
  quando o contador for igual a 103. Utilize o comando \comandobreak. 
  \item [Q. 11] Como podemos determinar o uso do comando \comandocontinue e qual a sua aplicação prática
  no \php? 
  \item [Q. 12] Crie um código com as seguintes características: (i) Deve receber um valor inicial e outro
  final; (ii) Deve conter um laço \comandofor~ que é limitado pelos valores inicial e final definido no tópico
  (i); (iii) Deve conter um controle de decisão (\comandoifelse) responsável por comparar o valor incrementado
  e definir se o número é par ou ímpar. Exemplo do que será calculado pelo código, tendo como valor inicial
  8 e valor final 12:
  \lstinputlisting[language=php,style=codigos]{codigos/cap5/exemplo-q12.php}

\end{description}



\section{Desafio!}
\label{cap5-desafio}
